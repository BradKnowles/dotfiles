{{ template "Header.tmpl" . }}
function Invoke-Starship-PreCommand {
	$icons=@{
		Admin = "üïµüèª‚Äç‚ôÇÔ∏è"
		Cloud = "‚òÅÔ∏è"
		Directory = "üìÅ"
	}

	$loc = $executionContext.SessionState.Path.CurrentLocation;
	$prompt = "$([char]27)]9;12$([char]7)"
	if ($loc.Provider.Name -eq "FileSystem")
	{
		$prompt += "$([char]27)]9;9;`"$($loc.ProviderPath)`"$([char]27)\"
	}
	$Host.UI.Write($prompt)
	
	$directory = Split-Path -Path $pwd -Leaf
	$directoryTitle = "$($icons.Directory) $directory"
	$title = $directoryTitle

	$user = [Security.Principal.WindowsPrincipal][Security.Principal.WindowsIdentity]::GetCurrent()
	if ($user.IsInRole([Security.Principal.WindowsBuiltInRole]::Administrator)) {
		$title = "$($icons.Admin) $title"
	}

	if ($Env:AWS_PROFILE) {
		$awsTitle = "$($icons.Cloud) $Env:AWS_PROFILE"
		$title += " $awsTitle"
	}

	$host.ui.RawUI.WindowTitle = $title
}

Invoke-Expression (&starship init powershell)
